#######################################################################################################################
#######################################################################################################################
# Title:        Python Electric Vehicle Power Toolkit (PyEVPowerKit)
# Topic:        EV Modeling
# File:         save
# Date:         18.03.2024
# Author:       Dr. Pascal A. Schirmer
# Version:      V.0.1
# Copyright:    Pascal Schirmer
#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
# Function Description
#######################################################################################################################
"""
A short description of the function goes here.
Inputs:     1)
            2)
            N)
Outputs:    1)
            2)
            M)
"""

#######################################################################################################################
# Import libs
#######################################################################################################################
# ==============================================================================
# Internal
# ==============================================================================

# ==============================================================================
# External
# ==============================================================================
from datetime import datetime
from pathlib import Path
import pandas as pd
import os
from scipy.io import savemat

#######################################################################################################################
# Additional Functions
#######################################################################################################################


#######################################################################################################################
# Main Function
#######################################################################################################################
def save(dataTime, path, setup):
    ###################################################################################################################
    # MSG IN
    ###################################################################################################################
    print("INFO: Saving result files")

    ###################################################################################################################
    # Initialisation
    ###################################################################################################################
    # ==============================================================================
    # Parameters
    # ==============================================================================
    now = datetime.now()
    dt_string = now.strftime("%d_%m_%Y_%H_%M_%S")

    # ==============================================================================
    # Variables
    # ==============================================================================
    dir_name = setup['Exp']['name']
    resultName = 'result_' + setup['Exp']['name'] + '_' + dt_string + '.mat'

    ###################################################################################################################
    # Saving
    ###################################################################################################################
    # ==============================================================================
    # Changing Path
    # ==============================================================================
    os.chdir(path['resPath'])

    # ==============================================================================
    # Saving Results
    # ==============================================================================
    # df = pd.DataFrame(dataTime)
    # df.to_csv(resultName, index=False)
    savemat(resultName, dataTime)

    # ==============================================================================
    # Changing Path
    # ==============================================================================
    os.chdir(path['basePath'])

    ###################################################################################################################
    # MSG Out
    ###################################################################################################################
    print("INFO: Saving results done")

    ###################################################################################################################
    # Return
    ###################################################################################################################
    return []

#######################################################################################################################
# References
#######################################################################################################################
